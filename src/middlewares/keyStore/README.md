# Purpose

'KeyStore' manages the keys of each provider in server side, so that client need not pass the keys in each request.

# How to use

'KeyStore' can be used with or without a master key. If a master key is provided, client need to pass a unique 'token' generated by the master key in request's 'Authorization' header, just like direct call to the llm provider. This 'token' will be exchanged with the actual key of 'KeyStore'.

If no master key is provided, there is no need to pass any 'token' in request's 'Authorization'

master key is enabled by setting 'LLM_GATEWAY_MASTER_KEY' environment variable to a non-empty string.

# Configuration

'KeyStore' read pre-configured keys from a key file named by 'LLM_GATEWAY_KEY_FILE' environment variable. The key file should be in JSON format, and should have the following structure:

```json
{
  "azure-openai": [
    {
      "apiKey": "",
      "resourceName": "",
      "deploymentId": "",
      "apiVersion": "",
      "modelName": ""
    }
  ],
  "bedrock": [
    {
      "accessKey": "",
      "accessId": "",
      "region": ""
    }
  ],
  "vertex-ai": [
    {
      "region": "",
      "projectId": "",
      "serviceAccountJson": ""
    }
  ],
  "deepseek": [
    {
      "apiKey": ""
    }
  ]
}
```

'azure-openai' , 'bedrock', 'vertex-ai' is special, because they need more settings than just a "apiKey", for most of the providers, only "apiKey" is needed, will be set to 'Authorization' header in request.

# Robin Round with multiple keys

For some request limit reasons, we may need to use multiple keys for the same provider sometime. 'KeyStore' supports this by using 'Robin Round' algorithm to select the key to use. This is why the keys are stored in an array.
